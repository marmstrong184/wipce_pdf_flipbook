<!doctype html>
<html>
<head>
<script type="text/javascript" src="http://code.jquery.com/jquery-1.7.1.min.js"></script>
<script type="text/javascript" src="../../turn.min.js"></script>

<style type="text/css">
body{
	background:#ccc;
}
#magazine{
	/* width:576px; */
	/* height:752px; */
	border: 1px solid magenta;
}
#magazine .turn-page{
	background-color:#ccc;
	background-size:100% 100%;
}

canvas {
	border: 1px solid red;
}
</style>
</head>
<body>

<div id="magazine">
	<div data-page="1"></div>
	<div data-page="2"></div>
	<div data-page="3"></div>
	<div data-page="4"></div>
	<div data-page="5"></div>
</div>


<script type="text/javascript">

	$(window).ready(function() {
		$('#magazine').turn({
							display: 'single',
							acceleration: true,
							gradients: !$.isTouch,
							elevation:50,
							when: {
								turned: function(e, page) {
									console.log('Current view: ', $(this).turn('view'));
								}
							}
						});
	});
	
	
	$(window).bind('keydown', function(e){
		
		if (e.keyCode==37)
			$('#magazine').turn('previous');
		else if (e.keyCode==39)
			$('#magazine').turn('next');
			
	});

 	// Function to generate a random color based on a seed (page number)
  	function seededRandomColor(seed) {
  	  const random = Math.sin(seed) * 10000; // Use sine function for randomness
  	  const r = Math.floor((random % 256 + 256) % 256); // Red value
  	  const g = Math.floor((random * 2 % 256 + 256) % 256); // Green value
  	  const b = Math.floor((random * 3 % 256 + 256) % 256); // Blue value
  	  return `rgb(${r},${g},${b})`; // Return as rgb color string
  	}

  	// Select all divs with the data-page attribute
  	const pages = document.querySelectorAll('#magazine div[data-page]');

	setTimeout(() => {
		pages.forEach(page => {
			// Get the page number from the data-page attribute
			const pageNumber = page.getAttribute('data-page');

			console.log('TEST', pageNumber)
			
			// Create a canvas element
			const canvas = document.createElement('canvas');
			
			// Set canvas dimensions
			canvas.width = 600;
			canvas.height = 400;
			
			// Get the drawing context of the canvas
			const ctx = canvas.getContext('2d');
			
			// Set random background color seeded by page number
			const bgColor = seededRandomColor(Number(pageNumber));
			ctx.fillStyle = bgColor;
			ctx.fillRect(0, 0, canvas.width, canvas.height); // Fill canvas background

			// Draw text with the page number onto the canvas
			ctx.font = '30px Arial';
			ctx.fillStyle = 'black';
			ctx.textAlign = 'center';
			ctx.textBaseline = 'middle';
			ctx.fillText('Page ' + pageNumber, canvas.width / 2, canvas.height / 2);
			
			// Append the canvas to the div
			page.appendChild(canvas);
		});
	}, 2000);

	$('#magazine').turn('size', 600, 400);

</script>

</body>
</html>
